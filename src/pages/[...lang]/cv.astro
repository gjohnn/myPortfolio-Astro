---
import MainLayout from "../../layouts/MainLayout.astro";
import { getLangFromUrl, t, localePath } from "../../i18n/utils";
import type { Lang } from "../../i18n/ui";

export function getStaticPaths() {
  return [
    { params: { lang: undefined } },
    { params: { lang: 'en' } },
  ];
}

const lang = getLangFromUrl(Astro.url) as Lang;
---

<MainLayout lang={lang}>
  <main class="relative max-w-7xl mx-auto">
    <!-- CV Header -->
    <section class="relative w-full mb-8 text-center animate-on-scroll px-4">
      <div class="relative z-10 max-w-4xl mx-auto">
        <div class="comic-action inline-block mb-4 animate-comic-pop" style="font-size: 0.8rem;">{t('cv.dossier', lang)}</div>
        <h1 class="comic-title text-4xl sm:text-5xl md:text-6xl mb-4" style="color: var(--comic-purple);">
          {t('cv.title', lang)}
        </h1>
        <p class="text-base sm:text-lg mb-6" style="font-family: var(--font-body); color: var(--gray-600); font-weight: 700;">
          {t('cv.subtitle', lang)}
        </p>

        <div class="flex flex-col sm:flex-row gap-3 sm:gap-4 justify-center items-center mb-8">
          <a href="/JuanGuerreroCv_Public.pdf" download="Juan_Sebastián_Guerrero_Britos_CV.pdf"
             class="btn btn-primary group w-full sm:w-auto px-6 sm:px-8 py-3 text-base sm:text-lg">
            <i class="fas fa-download mr-2"></i>
            {t('cv.downloadCv', lang)}
          </a>
          <a href={localePath('/contact', lang)} class="btn btn-secondary group w-full sm:w-auto px-6 sm:px-8 py-3 text-base sm:text-lg">
            <i class="fas fa-envelope mr-2"></i>
            {t('cv.contactMe', lang)}
          </a>
        </div>
      </div>
    </section>

    <!-- PDF Viewer -->
    <section class="relative w-full animate-on-scroll px-4">
      <div class="card p-4 sm:p-6" style="border-color: var(--comic-purple); border-width: 3px;">
        <div class="relative w-full" style="min-height: 80vh;">
          <!-- Desktop PDF -->
          <div class="hidden md:block w-full h-full">
            <iframe
              src="/JuanGuerreroCv_Public.pdf"
              class="w-full rounded-lg"
              style="height: 85vh; border: 3px solid var(--comic-black); box-shadow: 4px 4px 0 var(--comic-black);"
              title="Juan Sebastián Guerrero Britos - CV"
            ></iframe>
          </div>

          <!-- Mobile Fallback -->
          <div class="md:hidden">
            <div class="text-center p-8 rounded-lg" style="background: var(--comic-cream); border: 3px solid var(--comic-black);">
              <i class="fas fa-file-pdf text-6xl mb-4" style="color: var(--comic-red);"></i>
              <h3 class="comic-title text-xl mb-4" style="color: var(--comic-black);">
                {t('cv.viewMobile', lang)}
              </h3>
              <p class="mb-6" style="font-family: var(--font-body); color: var(--gray-600); font-weight: 700;">
                {t('cv.mobileDesc', lang)}
              </p>
              <a href="/JuanGuerreroCv_Public.pdf" target="_blank"
                 class="btn btn-primary inline-flex items-center gap-2 px-6 py-3">
                <i class="fas fa-external-link-alt"></i>
                {t('cv.openPdf', lang)}
              </a>
            </div>
          </div>
        </div>
      </div>

      <!-- Updated Info -->
      <div class="mt-8 text-center">
        <p class="text-sm" style="font-family: var(--font-accent); color: var(--gray-500);">
          {t('cv.lastUpdated', lang)} <span style="color: var(--comic-red); font-weight: bold;">November 2025</span>
        </p>
      </div>
    </section>
  </main>
</MainLayout>
